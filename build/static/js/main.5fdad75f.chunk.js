(this["webpackJsonpreact-todo"]=this["webpackJsonpreact-todo"]||[]).push([[0],{112:function(e,t,a){"use strict";a.r(t);var c=a(0),r=a.n(c),n=a(28),s=a.n(n),o=a(5),i=a(11),d=a(13),j=a(10),u=a(2),b=a(34);function l(e,t){switch(t.type){case"LOGIN":case"REGISTER":return{username:t.username,access_token:t.access_token};case"LOGOUT":return{username:void 0,access_token:void 0};default:return e}}function O(e,t){return"FETCH_USERS"===t.type?t.users:e}function h(e,t){switch(t.type){case"CREATE_TODO":return 0===e.filter((function(e){return e.id===t.id})).length?[{title:t.title,description:t.description,dateCreated:t.dateCreated,id:t.id,dateCompleted:null,complete:!1,creator:t.user}].concat(Object(b.a)(e)):e;case"TOGGLE_TODO":var a=new Date(Date.now());return e.map((function(e){return e._id===t.id?Object(u.a)(Object(u.a)({},e),{},{complete:!e.complete,dateCompleted:a.toDateString()}):e}));case"DELETE_TODO":return e.filter((function(e){return e._id!==t.id}));case"USER_TODO":return e.filter((function(e){return e.creator===t.creator}));case"FETCH_TODOS":return t.todos;default:return e}}function x(e,t){return{user:l(e.user,t),users:O(e.users,t),todos:h(e.todos,t)}}var f=a(8),p=a(1);function m(){var e=Object(c.useState)(""),t=Object(o.a)(e,2),a=t[0],r=t[1],n=Object(c.useState)(""),s=Object(o.a)(n,2),d=s[0],u=s[1],b=Object(c.useState)(""),l=Object(o.a)(b,2),O=l[0],h=l[1],x=Object(c.useContext)(f.a),m=x.state,g=x.dispatch,v=m.user,C=Object(j.d)(),w=Object(i.b)((function(e){var t=e.title,a=e.description,c=e.dateCreated,r=e.complete,n=e.dateCompleted,s=e.creator;return{url:"/todo",method:"post",headers:{Authorization:"".concat(m.user.access_token)},data:{title:t,description:a,dateCreated:c,complete:r,dateCompleted:n,creator:s}}})),T=Object(o.a)(w,2),E=T[0],y=T[1];return Object(c.useEffect)((function(){E&&E.data&&(g({type:"CREATE_TODO",title:E.data.title,description:E.data.description,dateCreated:E.data.dateCreated,id:E.data.id,creator:E.data.creator}),C.navigate("/todos/".concat(E.data.id)))}),[E]),Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),y({title:O,description:d,dateCreated:a,complete:!1,dateCompleted:null,creator:v})},children:[Object(p.jsxs)("div",{children:[Object(p.jsxs)("h4",{children:["Creator: ",v.username]}),Object(p.jsx)("label",{htmlFor:"create-title",children:"Title:"}),Object(p.jsx)("input",{type:"text",name:"create-title",id:"create-title",onChange:function(e){h(e.target.value);var t=new Date(Date.now());r(t.toDateString())},required:!0})]}),Object(p.jsxs)("div",{children:[Object(p.jsx)("label",{htmlFor:"create-description",children:"Description:"}),Object(p.jsx)("br",{}),Object(p.jsx)("textarea",{onChange:function(e){u(e.target.value)}})]}),Object(p.jsx)("input",{type:"submit",value:"Create"})]})}var g=a(119),v=a(123),C=a(121),w=a(80);function T(e){var t=e.show,a=e.handleClose,r=Object(c.useContext)(f.a).dispatch,n=Object(c.useState)({username:"",password:"",passwordRepeat:""}),s=Object(o.a)(n,2),d=s[0],j=s[1],b=Object(c.useState)(""),l=Object(o.a)(b,2),O=(l[0],l[1]),h=Object(i.b)((function(e,t){return{url:"auth/register",method:"post",data:{username:e,password:t,passwordConfirmation:t}}})),x=Object(o.a)(h,2),m=x[0],g=x[1];return Object(c.useEffect)((function(){m&&m.data&&r({type:"REGISTER",username:m.data.username,access_token:m.data.access_token})}),[m]),Object(c.useEffect)((function(){m&&!1===m.isLoading&&(m.data||m.error)&&(m.error?(console.log(m),O("Registration failed, please try again later."),alert("fail")):(console.log(m),O("Registration successful. You may now login."),alert("success")))}),[m]),Object(p.jsx)(v.a,{show:t,onHide:a,children:Object(p.jsxs)(C.a,{onSubmit:function(e){e.preventDefault(),g(d.username,d.password),a()},children:[Object(p.jsx)(v.a.Header,{closeButton:!0,children:Object(p.jsx)(v.a.Title,{children:"Register"})}),Object(p.jsxs)(v.a.Body,{children:[Object(p.jsx)(C.a.Label,{htmlFor:"register-username",children:"Username:"}),Object(p.jsx)(C.a.Control,{type:"text",value:d.username,onChange:function(e){return j(Object(u.a)(Object(u.a)({},d),{},{username:e.target.value}))},name:"register-username",id:"register-username"}),Object(p.jsx)(C.a.Label,{htmlFor:"register-password",children:"Password:"}),Object(p.jsx)(C.a.Control,{type:"password",name:"register-password",id:"register-password",value:d.password,onChange:function(e){return j(Object(u.a)(Object(u.a)({},d),{},{password:e.target.value}))}}),Object(p.jsx)(C.a.Label,{htmlFor:"register-password-repeat",children:"Repeat password:"}),Object(p.jsx)(C.a.Control,{type:"password",name:"register-password-repeat",id:"register-password-repeat",value:d.passwordRepeat,onChange:function(e){return j(Object(u.a)(Object(u.a)({},d),{},{passwordRepeat:e.target.value}))}})]}),Object(p.jsxs)(v.a.Footer,{children:[Object(p.jsx)(w.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(p.jsx)(w.a,{variant:"primary",type:"submit",disabled:0===d.username.length||0===d.password.length||d.password!==d.passwordRepeat,children:"Register"})]})]})})}function E(e){var t=e.show,a=e.handleClose,r=Object(c.useContext)(f.a).dispatch,n=Object(c.useState)(!1),s=Object(o.a)(n,2),d=s[0],j=s[1],u=Object(c.useState)(""),b=Object(o.a)(u,2),l=b[0],O=b[1],h=Object(c.useState)(""),x=Object(o.a)(h,2),m=x[0],g=x[1];var T=Object(i.b)((function(e,t){return{url:"auth/login",method:"post",data:{username:e,password:t}}})),E=Object(o.a)(T,2),y=E[0],D=E[1];return Object(c.useEffect)((function(){y&&!1===y.isLoading&&(y.data||y.error)&&(y.error?(j(!0),alert("failed")):(j(!1),console.log(y.data),r({type:"LOGIN",username:m,access_token:y.data.access_token})))}),[y]),Object(p.jsx)(v.a,{show:t,onHide:a,children:Object(p.jsxs)(C.a,{onSubmit:function(e){e.preventDefault(),D(m,l),a()},children:[Object(p.jsx)(v.a.Header,{closeButton:!0,children:Object(p.jsx)(v.a.Title,{children:"Login"})}),Object(p.jsxs)(v.a.Body,{children:[Object(p.jsx)(C.a.Label,{htmlFor:"login-username",children:"Username:"}),Object(p.jsx)(C.a.Control,{type:"text",value:m,onChange:function(e){g(e.target.value)},name:"login-username",id:"login-username"}),Object(p.jsx)(C.a.Label,{htmlFor:"login-password",children:"Password:"}),Object(p.jsx)(C.a.Control,{type:"password",value:l,onChange:function(e){O(e.target.value)},name:"login-password",id:"login-password"}),d&&Object(p.jsx)(C.a.Text,{style:{color:"red"},children:"Invalid username or password"})]}),Object(p.jsxs)(v.a.Footer,{children:[Object(p.jsx)(w.a,{variant:"secondary",onClick:a,children:"Cancel"}),Object(p.jsx)(w.a,{variant:"primary",disabled:0===m.length,type:"submit",children:"Login"})]})]})})}function y(){var e=r.a.lazy((function(){return a.e(3).then(a.bind(null,126))})),t=Object(c.useContext)(f.a).state.user,n=Object(c.useState)(!1),s=Object(o.a)(n,2),i=s[0],d=s[1],j=Object(c.useState)(!1),u=Object(o.a)(j,2),b=u[0],l=u[1];return t.username?Object(p.jsx)(e,{}):Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"justify-content-end",children:[Object(p.jsx)(w.a,{variant:"primary",onClick:function(e){return d(!0)},children:"Login"}),Object(p.jsx)(E,{show:i,handleClose:function(){return d(!1)}}),Object(p.jsx)(w.a,{variant:"primary",onClick:function(e){return l(!0)},children:"Register"}),Object(p.jsx)(T,{show:b,handleClose:function(){return l(!1)}})]})})}var D=a(125);function L(e){var t=e.title,a=e.description,r=e.dateCreated,n=e.complete,s=e.dateCompleted,d=e.id,u=e.index,b=Object(c.useContext)(f.a),l=b.state,O=b.dispatch,h=l.user,x=Object(j.d)(),m=Object(i.b)((function(){return{url:"/todo/".concat(d),method:"delete",headers:{Authorization:"".concat(h.access_token)}}})),g=Object(o.a)(m,2),v=g[0],C=g[1],w=Object(i.b)((function(e){var t=e.completed,a=e.dateComplete;return{url:"/todo/".concat(d),method:"patch",headers:{Authorization:"".concat(h.access_token)},data:{complete:t,dateCompleted:a}}})),T=Object(o.a)(w,2),E=T[0],y=T[1];function L(){C()}return Object(c.useEffect)((function(){v&&(v.data||v.error)&&!1===v.isLoading&&(v.error?alert("Unauthorized. This is not YOUR Todo"):(O({type:"DELETE_TODO",id:v.data.id}),x.navigate("/")))}),[v]),Object(c.useEffect)((function(){E&&(E.data||E.error)&&!1===E.isLoading&&(E.error?alert("Unauthorized. This is not YOUR Todo"):(O({type:"TOGGLE_TODO",id:E.data.id}),x.navigate("/")))}),[E]),n?Object(p.jsx)(D.a,{children:Object(p.jsxs)(D.a.Body,{children:[Object(p.jsx)(D.a.Title,{children:Object(p.jsxs)(j.a,{href:"/todos/".concat(d),children:[u+1,". ",t]})}),Object(p.jsxs)(D.a.Text,{children:[Object(p.jsx)("div",{children:a}),Object(p.jsx)("br",{}),Object(p.jsxs)("i",{children:["Date Created:",Object(p.jsx)("b",{children:r})]}),Object(p.jsx)("br",{}),Object(p.jsxs)("i",{children:["Date Completed:",Object(p.jsx)("b",{children:s})]}),Object(p.jsx)("br",{}),Object(p.jsx)("button",{onClick:function(e){L()},children:"DELETE "})]})]})}):Object(p.jsx)(D.a,{children:Object(p.jsxs)(D.a.Body,{children:[Object(p.jsx)(D.a.Title,{children:Object(p.jsxs)(j.a,{href:"/todos/".concat(d),children:[u+1,". ",t]})}),Object(p.jsxs)(D.a.Text,{children:[Object(p.jsx)("div",{children:a}),Object(p.jsx)("br",{}),Object(p.jsxs)("i",{children:["Date Created:",Object(p.jsx)("b",{children:r})]}),Object(p.jsx)("br",{}),Object(p.jsx)("input",{type:"checkbox",id:"completeCheck",checked:n,onChange:function(e){!function(){var e=new Date(Date.now());y({completed:!0,dateComplete:e.toDateString()})}()}}),Object(p.jsx)("label",{htmlFor:"completeCheck",children:" Task Completed? "}),Object(p.jsx)("br",{}),Object(p.jsx)("br",{}),Object(p.jsx)("button",{onClick:function(e){L()},children:"DELETE "})]})]})})}var _=r.a.memo(L);function k(){var e=Object(c.useContext)(f.a).state.todos;return Object(p.jsx)("div",{children:e.map((function(e,t){return Object(c.createElement)(_,Object(u.a)(Object(u.a)({},e),{},{id:e._id,index:t,key:"todo-"+t}))}))})}var S=a(122),R=function(e){e.user;return Object(p.jsx)(j.a,{href:"/",children:Object(p.jsx)(S.a.Brand,{children:"Todo Page"})})},U=a(124),F=a(120);function B(){var e=Object(c.useContext)(f.a).state.user;return Object(c.useEffect)((function(){e.username?document.title="".concat(e.username,"\u2019s Todos"):document.title="Todos"}),[e]),Object(p.jsx)(S.a,{bg:"light",expand:"lg",children:Object(p.jsxs)(g.a,{children:[Object(p.jsx)(S.a.Brand,{href:"/",children:Object(p.jsx)(R,{text:e})}),Object(p.jsx)(S.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(p.jsxs)(S.a.Collapse,{id:"basic-navbar-nav",children:[Object(p.jsx)(U.a,{className:"me-auto",children:e.username&&Object(p.jsx)(U.a.Link,{children:Object(p.jsx)(j.a,{href:"/todos/create",children:"Create New Todos"})})}),Object(p.jsx)(r.a.Suspense,{fallback:"Loading...",children:Object(p.jsx)(y,{})}),Object(p.jsx)(F.a,{title:"Dropdown",id:"basic-nav-dropdown",children:Object(p.jsx)(F.a.Item,{children:Object(p.jsx)(j.a,{href:"/users",children:"Users"})})})]})]})})}function G(e){var t=e.id,a=Object(c.useContext)(f.a).state.user,r=Object(i.b)((function(){return{url:"/todo/".concat(t),headers:{Authorization:"".concat(a.access_token)},method:"get"}})),n=Object(o.a)(r,2),s=n[0],d=n[1];return Object(c.useEffect)(d,[t]),Object(p.jsxs)("div",{children:[s&&s.data?Object(p.jsx)(_,Object(u.a)(Object(u.a)({},s.data),{},{index:0})):"Loading...",Object(p.jsx)("div",{children:Object(p.jsx)(j.a,{href:"/",children:"Go back"})})]})}function H(){var e=Object(c.useContext)(f.a),t=e.state,a=e.dispatch,r=Object(i.b)((function(){return{url:"/todo",method:"get",headers:{Authorization:"".concat(t.user.access_token)}}})),n=Object(o.a)(r,2),s=n[0],d=n[1];Object(c.useEffect)((function(){d()}),[t.user.access_token]),Object(c.useEffect)((function(){s&&!1===s.isLoading&&s.data&&a({type:"FETCH_TODOS",todos:s.data.todos.reverse()})}),[s]);s.data;var j=s.isLoading;return Object(p.jsxs)(p.Fragment,{children:[j&&"Todos loading..."," ",Object(p.jsx)(k,{})]})}function I(e){var t=e.username,a=e._id,r=Object(c.useContext)(f.a),n=(r.state,r.dispatch),s=Object(i.b)((function(){return{url:"/todo",method:"get"}})),d=Object(o.a)(s,2),u=d[0],b=d[1];Object(c.useEffect)((function(){b()}),[]),Object(c.useEffect)((function(){u&&!1===u.isLoading&&u.data&&(n({type:"FETCH_TODOS",todos:u.data.todos.reverse()}),console.log(a))}),[u]),Object(c.useEffect)((function(){u&&u.data&&!1===u.isLoading&&n({type:"USER_TODO",creator:a})}),[u]);u.data,u.isLoading;return Object(p.jsx)(D.a,{children:Object(p.jsxs)(D.a.Body,{children:[Object(p.jsx)(D.a.Title,{children:t}),Object(p.jsxs)(D.a.Text,{children:[Object(p.jsxs)("div",{children:["User ID: ",a]}),Object(p.jsx)(j.a,{href:"/users/".concat(a),children:"User Page"}),Object(p.jsx)(k,{})]})]})})}function z(){var e=Object(c.useContext)(f.a).state.users;return Object(p.jsx)("div",{children:e.map((function(e,t){return Object(p.jsx)(D.a,{children:Object(p.jsxs)(D.a.Body,{children:[Object(p.jsx)(D.a.Title,{children:e.username}),Object(p.jsxs)(D.a.Text,{children:[Object(p.jsxs)("div",{children:["User ID: ",e._id]}),Object(p.jsx)(j.a,{href:"/users/".concat(e._id),children:"User Page"})]})]})})}))})}function A(){var e=Object(c.useContext)(f.a),t=(e.state,e.dispatch),a=Object(i.b)((function(){return{url:"auth/users",method:"get"}})),r=Object(o.a)(a,2),n=r[0],s=r[1];Object(c.useEffect)(s,[]),Object(c.useEffect)((function(){n&&!1===n.isLoading&&n.data&&t({type:"FETCH_USERS",users:n.data.users})}),[n]);n.data;var d=n.isLoading;return Object(p.jsxs)("div",{children:[d&&"Users loading..."," ",Object(p.jsx)(z,{})]})}function P(e){var t=e.id,a=Object(c.useContext)(f.a),r=(a.state,a.dispatch,Object(i.b)((function(){return{url:"/auth/users/".concat(t),method:"get"}}))),n=Object(o.a)(r,2),s=n[0],d=n[1];return Object(c.useEffect)(d,[t]),Object(p.jsxs)("div",{children:[s&&s.data&&!1===s.isLoading?Object(p.jsx)(I,Object(u.a)({},s.data)):"Loading...",Object(p.jsx)("div",{children:Object(p.jsx)(j.a,{href:"/",children:"Go back"})})]})}var N=function(){var e=Object(c.useReducer)(x,{user:{},users:[],todos:[]}),t=Object(o.a)(e,2),a=t[0],r=t[1],n=Object(d.f)({"/":Object(d.g)({view:Object(p.jsx)(H,{})}),"/todos/create":Object(d.g)({view:Object(p.jsx)(m,{})}),"/todos/:id":Object(d.g)((function(e){return{view:Object(p.jsx)(G,{id:e.params.id})}})),"/users":Object(d.g)((function(e){return{view:Object(p.jsx)(A,{})}})),"/users/:id":Object(d.g)((function(e){return{view:Object(p.jsx)(P,{id:e.params.id})}}))});return Object(p.jsx)("div",{children:Object(p.jsx)(f.a.Provider,{value:{state:a,dispatch:r},children:Object(p.jsx)(j.b,{routes:n,children:Object(p.jsxs)(g.a,{children:[Object(p.jsx)(B,{}),Object(p.jsx)("hr",{}),Object(p.jsx)(j.c,{})]})})})})},Y=a(47),J=a.n(Y).a.create({baseURL:"/"});s.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(i.a,{value:J,children:Object(p.jsx)(N,{})})}),document.getElementById("root"))},8:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var c=a(0),r=a.n(c).a.createContext({state:{},dispatch:function(){}})}},[[112,1,2]]]);
//# sourceMappingURL=main.5fdad75f.chunk.js.map